<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Matrix Multiplication - COMP4601 Musings</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="z5206677"><meta name=description content="Implementation Default Synthesis  Sequential architecture One multiplier One adder BRAM High task latency and task interval  Unrolling the inner loop (dot product loop)  Could also use the UNROLL directive, but for manual sake ."><meta name=keywords content="featherbear,COMP4601,UNSW"><meta name=generator content="Hugo 0.68.3 with theme even"><link rel=canonical href=../matrix-multiplication/><link rel=apple-touch-icon sizes=180x180 href=../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../favicon-16x16.png><link rel=manifest href=../manifest.json><link rel=mask-icon href=../safari-pinned-tab.svg color=#5bbad5><link href=../sass/main.min.651e6917abb0239242daa570c2bec9867267bbcd83646da5a850afe573347b44.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../css/typedjs.shortcode.css><link rel=stylesheet href=../css/fixDetails.css><link rel=stylesheet href=../css/fancyBox.css><meta property="og:title" content="Matrix Multiplication"><meta property="og:description" content="Implementation Default Synthesis  Sequential architecture One multiplier One adder BRAM High task latency and task interval  Unrolling the inner loop (dot product loop)  Could also use the UNROLL directive, but for manual sake ."><meta property="og:type" content="article"><meta property="og:url" content="/matrix-multiplication/"><meta property="article:published_time" content="2022-06-30T10:12:22+00:00"><meta property="article:modified_time" content="2022-07-14T14:19:50+00:00"><meta itemprop=name content="Matrix Multiplication"><meta itemprop=description content="Implementation Default Synthesis  Sequential architecture One multiplier One adder BRAM High task latency and task interval  Unrolling the inner loop (dot product loop)  Could also use the UNROLL directive, but for manual sake ."><meta itemprop=datePublished content="2022-06-30T10:12:22+00:00"><meta itemprop=dateModified content="2022-07-14T14:19:50+00:00"><meta itemprop=wordCount content="195"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Matrix Multiplication"><meta name=twitter:description content="Implementation Default Synthesis  Sequential architecture One multiplier One adder BRAM High task latency and task interval  Unrolling the inner loop (dot product loop)  Could also use the UNROLL directive, but for manual sake ."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../ class=logo>COMP4601 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../><li class=mobile-menu-item>Home</li></a><a href=https://raw.githubusercontent.com/featherbear/UNSW-COMP4601/master/textbook/kastner-parallel-processing-fpgas.pdf><li class=mobile-menu-item>Textbook</li></a><a href=https://raw.githubusercontent.com/featherbear/UNSW-COMP4601/master/tutorials/ug871-vivado-high-level-synthesis-tutorial.pdf><li class=mobile-menu-item>Tutorials</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../ class=logo>COMP4601 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://raw.githubusercontent.com/featherbear/UNSW-COMP4601/master/textbook/kastner-parallel-processing-fpgas.pdf>Textbook</a></li><li class=menu-item><a class=menu-item-link href=https://raw.githubusercontent.com/featherbear/UNSW-COMP4601/master/tutorials/ug871-vivado-high-level-synthesis-tutorial.pdf>Tutorials</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Matrix Multiplication</h1><div class=post-meta><span class=post-time>2022-06-30</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#implementation>Implementation</a></li><li><a href=#default-synthesis>Default Synthesis</a></li><li><a href=#unrolling-the-inner-loop-dot-product-loop>Unrolling the inner loop (dot product loop)</a></li><li><a href=#sequential-implementation-of-the-unrolled-inner-loop>Sequential implementation of the unrolled inner loop</a></li><li><a href=#pipelined-execution-of-the-inner-loop>Pipelined execution of the inner loop</a></li><li><a href=#pipelined-operators-ie-multipliers>Pipelined Operators (i.e. Multipliers)</a></li><li><a href=#with-complete-array-partitioning>With Complete Array Partitioning</a></li><li><a href=#with-dual-port-ram-and-array-partitioning-f2>With Dual-Port RAM and Array Partitioning f=2</a></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=implementation>Implementation</h2><p><img src=../uploads/snipaste_2022-06-30_19-31-30.jpg alt></p><h2 id=default-synthesis>Default Synthesis</h2><p><img src=../uploads/snipaste_2022-06-30_19-33-28.jpg alt></p><ul><li>Sequential architecture</li><li>One multiplier</li><li>One adder</li><li>BRAM</li><li>High task latency and task interval</li></ul><h2 id=unrolling-the-inner-loop-dot-product-loop>Unrolling the inner loop (dot product loop)</h2><blockquote><p>Could also use the UNROLL directive, but for manual sake ...</p></blockquote><p><img src=../uploads/snipaste_2022-06-30_19-35-19.jpg alt><br><img src=../uploads/snipaste_2022-06-30_19-35-59.jpg alt></p><h2 id=sequential-implementation-of-the-unrolled-inner-loop>Sequential implementation of the unrolled inner loop</h2><p><img src=../uploads/snipaste_2022-06-30_19-38-17.jpg alt></p><ul><li>Could do multiplication in several stages, and therefore start adding in advanced<ul><li>Note: A mux would be needed, and requires 1 LUT per bit</li></ul></li></ul><h2 id=pipelined-execution-of-the-inner-loop>Pipelined execution of the inner loop</h2><p><img src=../uploads/snipaste_2022-06-30_19-41-34.jpg alt></p><p>Task latency -> <code>3*size + 3</code></p><h2 id=pipelined-operators-ie-multipliers>Pipelined Operators (i.e. Multipliers)</h2><blockquote><p><strong>Note: A bunch of different things within the FPGA are already pipelined</strong></p></blockquote><p><img src=../uploads/snipaste_2022-06-30_19-46-50.jpg alt></p><p>Task Latency -> <code>3*size + 5</code></p><p>Note: Higher latency, but less multipliers</p><h2 id=with-complete-array-partitioning>With Complete Array Partitioning</h2><p>See <a href=../array-partitioning>Array Partitioning</a></p><p>Task Latency -> <code>size + 5</code></p><p>Note: Very high resource count</p><h2 id=with-dual-port-ram-and-array-partitioning-f2>With Dual-Port RAM and Array Partitioning f=2</h2><p>See <a href=../array-partitioning>Array Partitioning</a></p><p>For instances where there are only two accesses, we could get away with using a dual-port ram and not need to partition the array completely.</p><blockquote><p>If we are using a partitioning factor of f=2, we only have at most 2^f = 2^2 = 4 IOs (assuming using dual-port), provided we keep <code>II=1</code></p><p>Larger factors would require muxes and incur an increased <code>II</code></p></blockquote></div><footer class=post-footer><nav class=post-nav><a class=prev href=../array-partitioning/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Array Partitioning</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../identifying-performance-bottlenecks/><span class="next-text nav-default">Identifying Performance Bottlenecks</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2022
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../js/typed.js@2.0.9></script><script src=../js/typedjs.shortcode.js></script></body></html>